(function($){$.fn.jBrowserBookmark=function(options,lang){var defaults=$.extend(opts={language:{'':['Press [key] + ',' to bookmark this page.']},defaultLanguage:'',functionButton:['CTRL','CMD']},options);var docUrl=window.location.href;var docTitle=document.title;var browserName;browserName=getBrowser();return this.each(function(){$(this).click(function(e){e.preventDefault();try{switch(browserName){case'konqueror':case'firefox':window.sidebar.addPanel(docTitle,docUrl,'');break;case'msie':window.external.AddFavorite(docUrl,docTitle);break;case'opera':if(versionOpera()<11){$(this).attr('rel','sidebar').attr('title',docTitle).attr('href',docUrl);break}else{throw error}default:throw error}}catch(error){var hotkey=getHotkey(browserName);var alertText=getLanguageText();if(/mac/.test(navigator.platform.toLowerCase()=='mac')){prefix=alertText[0].replace('[key]',opts.functionButton[1])}else{prefix=alertText[0].replace('[key]',opts.functionButton[0])}alert(prefix+hotkey+alertText[1])}})});function getBrowser(){if($.browser.msie){return'msie'}if($.browser.mozilla){return'firefox'}if($.browser.opera){return'opera'}if($.browser.safari&&/chrome/.test(navigator.userAgent.toLowerCase())){return'chrome'}if($.browser.safari){return'safari'}if(/konqueror/.test(navigator.userAgent.toLowerCase())){return'konqueror'}}function getHotkey(browserName){switch(browserName){case'konqueror':return'B';break;case'opera':return(versionOpera()<9)?'T':'D';break;default:return'D';break}}function getLanguageText(){var languageChosen;if(opts.language[lang]!=undefined){languageChosen=lang}else{if(opts.language[navigator.language.toLowerCase().substring(0,2)]!=undefined){languageChosen=navigator.language.toLowerCase().substring(0,2)}else{if(opts.language[opts.defaultLanguage]!=undefined)languageChosen=opts.defaultLanguage;else{for(var i in opts.language){languageChosen=i;break}}}}return opts.language[languageChosen]}function versionOpera(){version=navigator.userAgent.substring(navigator.userAgent.toLowerCase().indexOf('version/')+8);return parseInt(version.substring(0,version.indexOf('.')))}}})(jQuery);
